# Word-Excel 批量替换工具

# 📋 Word+Excel 批量替换工具

🚀 **智能文档批量处理工具** - 让Word和Excel的批量替换变得简单高效！

## ✨ 核心功能

- 🔄 **批量替换** - 基于Excel数据批量替换Word文档内容

- 📊 **表格支持** - 完美支持Word表格内的文字替换

- 🎨 **格式保留** - 替换后保持原有字体、颜色、样式不变

- 🖥️ **可视化界面** - 友好的Web操作界面，无需编程经验

- 📦 **灵活下载** - 支持单个文件下载和ZIP压缩包批量下载

- 💾 **结果持久化** - 替换结果在会话期间持久保存

- 📤📥 **替换规则导入/导出** - 支持JSON格式导入导出替换规则，方便重复使用

- 🔢 **数值精度修复** - 智能修复Excel中公式计算后数值精度问题（如0.48729999999999996被修复为0.4873）

- 📊 **列类型智能识别** - 针对"合计"等特殊列进行专门处理，确保数值格式正确

- 🔍 **高精度计算** - 使用Decimal类型进行精确计算，避免浮点数二进制表示导致的精度损失

- 📛 **文件后缀自定义** - 支持为生成的文件名添加自定义后缀

- 🖱️ **行选中效果** - 规则列表和导出结果表格提供清晰的行选中视觉反馈

- 📋 **灵活的替换范围** - 支持替换完整关键词或仅替换括号内内容

- 🎯 **规则去重** - 导入替换规则时自动去重，避免重复替换

- 📝 **友好的错误提示** - 提供详细的错误信息和操作指导

## 🚀 快速开始

### 🐳 Docker 一键部署（推荐）

```Bash
version: '3.8'
services:
  word-excel-replace:
    image: ghcr.io/marod1m/wordreplace:latest
    container_name: Wordreplace-tool
    network_mode: bridge
    ports:
      - "12344:8501"
    restart: no
    environment:
      - STREAMLIT_SERVER_HEADLESS=true
      - STREAMLIT_BROWSER_GATHER_USAGE_STATS=false

```

### ⚡ 本地运行

```Bash
git clone https://github.com/你的用户名/wordreplace.git
cd wordreplace
pip install -r requirements.txt
streamlit run app/main.py
```

## 📖 使用流程

1. 📄 **上传文件**
    - Word模板：上传.docx格式的模板文档
    - Excel数据：上传.xlsx/.xls格式的数据文件

2. 👀 **预览文档**
    - 查看Word文档内容（含表格）
    - 选中关键字并按Ctrl+C复制
    - 预览Excel数据结构和列名

3. ⚙️ **设置规则**
    - **替换范围设置**：选择替换完整关键词或仅替换括号内内容
    - **规则管理**：
      - 手动添加：粘贴关键字，选择对应Excel列，点击添加
      - 批量导入：上传JSON格式的替换规则文件
      - 批量导出：将当前规则导出为JSON文件保存
    - **规则列表**：查看所有添加的规则，支持单个删除

4. 🚀 **执行替换**
    - **文件名设置**：
      - 选择核心字段（Excel列）作为文件名基础
      - 设置文件前缀（可选）
      - 设置文件后缀（可选）
    - **替换范围**：选择全部行或指定行范围
    - 点击"开始替换"按钮执行批量替换

5. 📥 **下载结果**
    - **单文件下载**：分页显示生成的文件，每行显示文件名和下载按钮
    - **批量下载**：一键下载所有文件的ZIP压缩包
    - **替换日志**：查看详细的替换过程日志

## 🛠️ 技术栈

|技术|用途|版本|链接|
|---|---|---|---|
|🐍 Python|后端逻辑处理|3.10+|[Python官网](https://www.python.org/)|
|🎈 Streamlit|Web界面框架|1.51.0+|[Streamlit官网](https://streamlit.io/)|
|📊 Pandas|数据处理|2.0+|[Pandas文档](https://pandas.pydata.org/)|
|📄 python-docx|Word文档处理|0.8.11+|[python-docx文档](https://python-docx.readthedocs.io/)|
|📊 openpyxl|Excel文件处理|3.1+|[openpyxl文档](https://openpyxl.readthedocs.io/)|
|🐳 Docker|容器化部署|20.10+|[Docker官网](https://www.docker.com/)|

## 🔧 常见问题与解决方案

### Q: 为什么替换后格式会丢失？
A: 工具会尽量保留原始格式，但过于复杂的格式可能无法完全保留。建议使用简单、规范的Word模板。

### Q: 为什么Excel中的数值精度有问题？
A: 工具已内置数值精度修复功能，会自动处理浮点数精度问题。若仍有问题，可检查Excel源文件格式。

### Q: 替换规则导入失败？
A: 请确保JSON格式正确，每个规则应包含"keyword"和"excel_column"字段，如：
```json
[
  {"keyword": "【姓名】", "excel_column": "姓名"},
  {"keyword": "(日期)", "excel_column": "日期"}
]
```

### Q: 支持哪些类型的括号？
A: 支持【】、（）、()、〔〕等常见括号格式，可选择仅替换括号内内容。

## 📝 更新日志

### v1.2.0（最新版本）
- ✨ 新增文件后缀自定义功能
- ✨ 新增行选中视觉效果
- 🎨 优化整体界面布局和样式
- 🐛 修复按钮错位问题
- 📖 更新使用文档和部署说明

### v1.1.0
- ✨ 新增替换范围选择功能
- ✨ 新增规则导入/导出功能
- 🔍 优化数值精度修复算法
- 🎨 改进界面布局和用户体验

### v1.0.0
- 🎉 初始版本发布
- 🔄 基础批量替换功能
- 📊 Word表格支持
- 🎨 格式保留功能
- 📦 灵活下载选项

## 🛠️ 技术栈

|技术|用途|
|---|---|
|🐍 Python 3.10+|后端逻辑处理|
|🎈 Streamlit 1.51.0|Web界面框架|
|📊 Pandas|数据处理|
|📄 python-docx|Word文档处理|
|📊 openpyxl|Excel文件处理|
|🐳 Docker|容器化部署|
## ⚡ 使用建议

### 💡 最佳实践：

- 单次处理建议不超过1000行数据

- 文件大小建议控制在50MB以内

- 确保服务器有2GB+可用内存

- 大文件建议分批次处理

### 🛡️ 安全提示：

- 所有处理在内存中进行

- 会话结束自动清理数据

- 建议在可信网络环境使用

⭐ 如果这个项目对你有帮助，请给我们一个Star！

🌐 访问地址：[http://localhost:12344](http://localhost:12344)（部署后）
